# P1<-ggplot(data,aes(x=IR,y=P,fill=class,shape=class)) +
#   geom_point(size=3,colour="black",stroke=0.25)+
#   scale_fill_manual(values=c("#36BED9","#FBAD01"))+
#   scale_shape_manual(values=c(21,22))+
# theme(legend.position = "top",
#       axis.text.x = element_text(size = 16, family = "Times New Roman"),  # 设置x轴标签字体大小为16
#       axis.text.y = element_text(size = 16, family = "Times New Roman"),  # 设置y轴标签字体大小为16
#       axis.title.x = element_text(size = 16, family = "Times New Roman"), # 设置x轴标题字体大小为16
#       axis.title.y = element_text(size = 16, family = "Times New Roman"),
#       panel.grid.major = element_blank(),  # Remove major grid lines
#       panel.grid.minor = element_blank(),  # Remove minor grid lines
#       panel.background = element_rect(fill = "white", color = NA), # Set pure white background
#       plot.background = element_rect(fill = "white", color = NA), # Set pure white background
#       panel.border = element_blank(),  # Remove the panel border
#       axis.line = element_line(size = 1)  # Set axis line size to 1
# ) +ylim(-300, 400) +
# labs(x = "IR", y = "ΔP")   # 添加x轴和y轴标题
# 设置整体基础字体大小为16
theme<-theme_minimal()+theme(
axis.title=element_text(size=22,face="plain",color="black"),
axis.text = element_text(size=22,face="plain",color="black"),
legend.text= element_text(size=22,face="plain",color="black"),
legend.title=element_blank(),
legend.background=element_rect(fill=NA,colour=NA),
panel.grid.major = element_blank(),  # Remove major grid lines
panel.grid.minor = element_blank(),
axis.line = element_line(size = 1)+ylim(-150, 100) # Remove minor grid lines
)
P1<-ggscatterhist(
data, x = "IM", y = "ΔP",  #iris
shape=21,color ="black",fill= "class", size =4.0, alpha = 1,
palette = c( "#00AFBB", "#FC4E07"),
margin.plot =  "boxplot",
margin.params = list(fill = "class", color = "black", size = 0.2),
legend = c(0.82,0.15),
ggtheme = theme)
# 添加横坐标和纵坐标标签
dat<-tribble(
~coefficient,~Estimate,~CI.min,~CI.max,~var,~perc,
"Elevation", 0.139,0.2,0.3,"Topographic",13.9,
"Slope", 0.196,2,3,"Topographic",19.6,
"SM",0.03,2,3,"Hydrologic",2.6,
"Distance to water",0.10,3,4,"Hydrologic",10.0,
"Soil type",0.09,6,7,"Hydrologic",9.2,
"Distance to road",0.106,2,3,"Anthropic",10.6,
"Impervious area ratio",0.339,5,6,"Anthropic",33.9,
)
dat <- dat %>%
group_by(var) %>%
mutate(label = if_else(row_number() == 1, var, ""))
dat <- dat %>%
mutate(coefficient = factor(coefficient, levels = unique(coefficient))) %>%
arrange(coefficient)
p1<-ggplot(data=dat, aes(x=Estimate, y=coefficient,color=var))+
geom_vline(xintercept=0, color = "grey",linetype="dashed", lwd=1.5)+
geom_errorbar(aes(xmin=0, xmax=1),
width=.2,lwd=1) +
geom_point(size=6)+
scale_color_manual(values =c("#FFD04D","#1DA362","#4587F4"))+ #手动配色，这里我用的google drive的配色
theme_classic(base_size = 22)+ #经典主题
theme(legend.position = "none")+
theme(axis.text.x = element_text(size = 22, color = "black"))+
theme(axis.text.y = element_text(size = 22, color = "black"))+
theme(title=element_text(size=22))+
labs(title =expression(paste("R"^2, "=0.98", "  p", "<0.001")),x = "Rate of contribution",y="")+
scale_y_discrete(position = "right", limits = rev(dat$coefficient))+
theme(axis.line.y=element_blank(),
axis.ticks.y=element_blank())
p1
####作堆积条形图
p2<-ggplot(dat, aes(x=factor(1),y=perc,fill=var, group = var))+
geom_bar(stat="identity")+ #堆积条形图
geom_text(aes(label = label), position = position_stack(vjust = 0.5)) + # Add labels A, B, C +
theme(axis.text.x = element_blank())+labs(x = "",y = "Relative effect (%)")+
theme_classic(base_size = 22)+
scale_fill_manual(values =c("#FFD04D","#1DA362","#4587F4"))+#注意颜色顺序
theme(legend.position = "none",
axis.text.x=element_blank(),
axis.line.x=element_blank(),
axis.ticks.x=element_blank())+
theme(axis.text.x = element_text(size = 22, color = "black"))+
theme(axis.text.y = element_text(size = 22, color = "black"))+
theme(title=element_text(size=22))+ theme(axis.line=element_line(size=1))
print(p2)
####拼图
library(patchwork)
P2<-p2+p1+plot_layout(widths = c(1,3))
# 将ggplot对象转换为"grobs"
print(P2)
View(data)
p2<-ggplot(dat, aes(x=factor(1),y=perc,fill=var, group = var))+
geom_bar(stat="identity")+ #堆积条形图
geom_text(aes(label = label), position = position_stack(vjust = 0.5)) + # Add labels A, B, C +
theme(axis.text.x = element_blank())+labs(x = "",y = "Relative effect (%)")+
theme_classic(base_size = 22)+
scale_fill_manual(values =c("#FFD04D","#1DA362","#4587F4"))+#注意颜色顺序
theme(legend.position = "none",
axis.text.x=element_blank(),
axis.line.x=element_blank(),
axis.ticks.x=element_blank())+
theme(axis.text.x = element_text(size = 22, color = "black"))+
theme(axis.text.y = element_text(size = 22, color = "black"))+
theme(title=element_text(size=22))+ theme(axis.line=element_line(size=1))
print(p2)
p2<-ggplot(dat, aes(x=factor(1),y=perc,fill=var, group = var))+
geom_bar(stat="identity")+ #堆积条形图
geom_text(aes(label = label), position = position_stack(vjust = 0.5)) + # Add labels A, B, C +
theme(axis.text.x = element_blank())+labs(x = "",y = "Relative effect (%)")+
theme_classic(base_size = 26)+
scale_fill_manual(values =c("#FFD04D","#1DA362","#4587F4"))+#注意颜色顺序
theme(legend.position = "none",
axis.text.x=element_blank(),
axis.line.x=element_blank(),
axis.ticks.x=element_blank())+
theme(axis.text.x = element_text(size = 26, color = "black"))+
theme(axis.text.y = element_text(size = 26, color = "black"))+
theme(title=element_text(size=26))+ theme(axis.line=element_line(size=1))
print(p2)
####拼图
dat<-tribble(
~coefficient,~Estimate,~CI.min,~CI.max,~var,~perc,
"Elevation", 0.139,0.2,0.3,"Topographic",13.9,
"Slope", 0.196,2,3,"Topographic",19.6,
"SM",0.03,2,3,"Hydrologic",2.6,
"Distance to water",0.10,3,4,"Hydrologic",10.0,
"Soil type",0.09,6,7,"Hydrologic",9.2,
"Distance to road",0.106,2,3,"Anthropic",10.6,
"Impervious area ratio",0.339,5,6,"Anthropic",33.9,
)
dat <- dat %>%
group_by(var) %>%
mutate(label = if_else(row_number() == 1, var, ""))
dat <- dat %>%
mutate(coefficient = factor(coefficient, levels = unique(coefficient))) %>%
arrange(coefficient)
p1<-ggplot(data=dat, aes(x=Estimate, y=coefficient,color=var))+
geom_vline(xintercept=0, color = "grey",linetype="dashed", lwd=1.5)+
geom_errorbar(aes(xmin=0, xmax=1),
width=.2,lwd=1) +
geom_point(size=6)+
scale_color_manual(values =c("#FFD04D","#1DA362","#4587F4"))+ #手动配色，这里我用的google drive的配色
theme_classic(base_size = 22)+ #经典主题
theme(legend.position = "none")+
theme(axis.text.x = element_text(size = 22, color = "black"))+
theme(axis.text.y = element_text(size = 22, color = "black"))+
theme(title=element_text(size=22))+
labs(title =expression(paste("R"^2, "=0.98", "  p", "<0.001")),x = "Rate of contribution",y="")+
scale_y_discrete(position = "right", limits = rev(dat$coefficient))+
theme(axis.line.y=element_blank(),
axis.ticks.y=element_blank())
p1
library(patchwork)
P2<-p2+p1+plot_layout(widths = c(1,3))
print(P2)
theme<-theme_minimal()+theme(
axis.title=element_text(size=22,face="plain",color="black"),
axis.text = element_text(size=22,face="plain",color="black"),
legend.text= element_text(size=22,face="plain",color="black"),
legend.title=element_blank(),
legend.background=element_rect(fill=NA,colour=NA),
panel.grid.major = element_blank(),  # Remove major grid lines
panel.grid.minor = element_blank(),
axis.line = element_line(size = 1)+ylim(-150, 100) # Remove minor grid lines
)
P1<-ggscatterhist(
data, x = "IM", y = "ΔP",  #iris
shape=21,color ="black",fill= "class", size =4.0, alpha = 1,
palette = c( "#00AFBB", "#FC4E07"),
margin.plot =  "boxplot",
margin.params = list(fill = "class", color = "black", size = 0.2),
legend = c(0.82,0.15),
ggtheme = theme)
# 添加横坐标和纵坐标标签
dat<-tribble(
~coefficient,~Estimate,~CI.min,~CI.max,~var,~perc,
"Elevation", 0.139,0.2,0.3,"Topographic",13.9,
"Slope", 0.196,2,3,"Topographic",19.6,
"SM",0.03,2,3,"Hydrologic",2.6,
"Distance to water",0.10,3,4,"Hydrologic",10.0,
"Soil type",0.09,6,7,"Hydrologic",9.2,
"Distance to road",0.106,2,3,"Anthropic",10.6,
"Impervious area ratio",0.339,5,6,"Anthropic",33.9,
)
dat <- dat %>%
group_by(var) %>%
mutate(label = if_else(row_number() == 1, var, ""))
dat <- dat %>%
mutate(coefficient = factor(coefficient, levels = unique(coefficient))) %>%
arrange(coefficient)
p1<-ggplot(data=dat, aes(x=Estimate, y=coefficient,color=var))+
geom_vline(xintercept=0, color = "grey",linetype="dashed", lwd=1.5)+
geom_errorbar(aes(xmin=0, xmax=1),
width=.2,lwd=1) +
geom_point(size=6)+
scale_color_manual(values =c("#FFD04D","#1DA362","#4587F4"))+ #手动配色，这里我用的google drive的配色
theme_classic(base_size = 22)+ #经典主题
theme(legend.position = "none")+
theme(axis.text.x = element_text(size = 22, color = "black"))+
theme(axis.text.y = element_text(size = 22, color = "black"))+
theme(title=element_text(size=22))+
labs(title =expression(paste("R"^2, "=0.98", "  p", "<0.001")),x = "Rate of contribution",y="")+
scale_y_discrete(position = "right", limits = rev(dat$coefficient))+
theme(axis.line.y=element_blank(),
axis.ticks.y=element_blank())
p1
####作堆积条形图
p2<-ggplot(dat, aes(x=factor(1),y=perc,fill=var, group = var))+
geom_bar(stat="identity")+ #堆积条形图
geom_text(aes(label = label), position = position_stack(vjust = 0.5)) + # Add labels A, B, C +
theme(axis.text.x = element_blank())+labs(x = "",y = "Relative effect (%)")+
theme_classic(base_size = 26)+
scale_fill_manual(values =c("#FFD04D","#1DA362","#4587F4"))+#注意颜色顺序
theme(legend.position = "none",
axis.text.x=element_blank(),
axis.line.x=element_blank(),
axis.ticks.x=element_blank())+
theme(axis.text.x = element_text(size = 26, color = "black"))+
theme(axis.text.y = element_text(size = 26, color = "black"))+
theme(title=element_text(size=26))+ theme(axis.line=element_line(size=1))
print(p2)
####拼图
library(patchwork)
P2<-p2+p1+plot_layout(widths = c(1,3))
# 将ggplot对象转换为"grobs"
print(P2)
dat<-tribble(
~coefficient,~Estimate,~CI.min,~CI.max,~var,~perc,
"Elevation", 0.139,0.2,0.3,"Topographic",13.9,
"Slope", 0.196,2,3,"Topographic",19.6,
"SM",0.03,2,3,"Hydrologic",2.6,
"Distance to water",0.10,3,4,"Hydrologic",10.0,
"Soil type",0.09,6,7,"Hydrologic",9.2,
"Distance to road",0.106,2,3,"Anthropic",10.6,
"Impervious area ratio",0.339,5,6,"Anthropic",33.9,
)
dat <- dat %>%
group_by(var) %>%
mutate(label = if_else(row_number() == 1, var, ""))
dat <- dat %>%
mutate(coefficient = factor(coefficient, levels = unique(coefficient))) %>%
arrange(coefficient)
p1<-ggplot(data=dat, aes(x=Estimate, y=coefficient,color=var))+
geom_vline(xintercept=0, color = "grey",linetype="dashed", lwd=1.5)+
geom_errorbar(aes(xmin=0, xmax=1),
width=.2,lwd=1) +
geom_point(size=6)+
scale_color_manual(values =c("#FFD04D","#1DA362","#4587F4"))+ #手动配色，这里我用的google drive的配色
theme_classic(base_size = 22)+ #经典主题
theme(legend.position = "none")+
theme(axis.text.x = element_text(size = 22, color = "black"))+
theme(axis.text.y = element_text(size = 22, color = "black"))+
theme(title=element_text(size=22))+
labs(title =expression(paste("R"^2, "=0.98", "  p", "<0.001")),x = "Rate of contribution",y="")+
scale_y_discrete(position = "right", limits = rev(dat$coefficient))+
theme(axis.line.y=element_blank(),
axis.ticks.y=element_blank())
p1
####作堆积条形图
p2<-ggplot(dat, aes(x=factor(1),y=perc,fill=var, group = var))+
geom_bar(stat="identity")+ #堆积条形图
geom_text(aes(label = label), position = position_stack(vjust = 0.5)) + # Add labels A, B, C +
theme(axis.text.x = element_blank())+labs(x = "",y = "Relative effect (%)")+
theme_classic(base_size = 26)+
scale_fill_manual(values =c("#FFD04D","#1DA362","#4587F4"))+#注意颜色顺序
theme(legend.position = "none",
axis.text.x=element_blank(),
axis.line.x=element_blank(),
axis.ticks.x=element_blank())+
theme(axis.text.x = element_text(size = 26, color = "black"))+
theme(axis.text.y = element_text(size = 26, color = "black"))+
theme(title=element_text(size=26))+ theme(axis.line=element_line(size=1))
print(p2)
####拼图
library(patchwork)
P2<-p2+p1+plot_layout(widths = c(1,3))
# 将ggplot对象转换为"grobs"
print(P2)
p2<-ggplot(dat, aes(x=factor(1),y=perc,fill=var, group = var))+
geom_bar(stat="identity")+ #堆积条形图
geom_text(aes(label = label), position = position_stack(vjust = 0.5)) + # Add labels A, B, C +
theme(axis.text.x = element_blank())+labs(x = "",y = "Relative effect (%)")+
theme_classic(base_size = 26)+
scale_fill_manual(values =c("#FFD04D","#1DA362","#4587F4"))+#注意颜色顺序
theme(legend.position = "none",
axis.text.x=element_blank(),
axis.line.x=element_blank(),
axis.ticks.x=element_blank())+
theme(axis.text.x = element_text(size = 26, color = "black"))+
theme(axis.text.y = element_text(size = 26, color = "black"))+
theme(title=element_text(size=26))+ theme(axis.line=element_line(size=1))
print(p2)
p2<-ggplot(dat, aes(x=factor(1),y=perc,fill=var, group = var))+
geom_bar(stat="identity")+ #堆积条形图
geom_text(aes(label = label), position = position_stack(vjust = 0.5)) + # Add labels A, B, C +
theme(axis.text.x = element_blank())+labs(x = "",y = "Relative effect (%)")+
theme_classic(base_size = 26)+
scale_fill_manual(values =c("#FFD04D","#1DA362","#4587F4"))+#注意颜色顺序
theme(legend.position = "none",
axis.text.x=element_blank(),
axis.line.x=element_blank(),
axis.ticks.x=element_blank())+
theme(axis.text.x = element_text(size = 26, color = "black"))+
theme(axis.text.y = element_text(size = 26, color = "black"))+
theme(title=element_text(size=30))+ theme(axis.line=element_line(size=1))
print(p2)
####作堆积条形图
p2<-ggplot(dat, aes(x=factor(1),y=perc,fill=var, group = var))+
geom_bar(stat="identity")+ #堆积条形图
geom_text(aes(label = label), position = position_stack(vjust = 0.5)) + # Add labels A, B, C +
theme(axis.text.x = element_blank())+labs(x = "",y = "Relative effect (%)")+
theme_classic(base_size = 30)+
scale_fill_manual(values =c("#FFD04D","#1DA362","#4587F4"))+#注意颜色顺序
theme(legend.position = "none",
axis.text.x=element_blank(),
axis.line.x=element_blank(),
axis.ticks.x=element_blank())+
theme(axis.text.x = element_text(size = 26, color = "black"))+
theme(axis.text.y = element_text(size = 26, color = "black"))+
theme(title=element_text(size=10))+ theme(axis.line=element_line(size=1))
print(p2)
####作堆积条形图
p2<-ggplot(dat, aes(x=factor(1),y=perc,fill=var, group = var))+
geom_bar(stat="identity")+ #堆积条形图
geom_text(aes(label = label), position = position_stack(vjust = 0.5)) + # Add labels A, B, C +
theme(axis.text.x = element_blank())+labs(x = "",y = "Relative effect (%)")+
theme_classic(base_size = 30)+
scale_fill_manual(values =c("#FFD04D","#1DA362","#4587F4"))+#注意颜色顺序
theme(legend.position = "none",
axis.text.x=element_blank(),
axis.line.x=element_blank(),
axis.ticks.x=element_blank())+
theme(axis.text.x = element_text(size = 26, color = "black"))+
theme(axis.text.y = element_text(size = 26, color = "black"))+
theme(title=element_text(size=26))+ theme(axis.line=element_line(size=1))
print(p2)
p2<-ggplot(dat, aes(x=factor(1),y=perc,fill=var, group = var))+
geom_bar(stat="identity")+ #堆积条形图
geom_text(aes(label = label), position = position_stack(vjust = 0.5)) + # Add labels A, B, C +
theme(axis.text.x = element_blank())+labs(x = "",y = "Relative effect (%)")+
theme_classic(base_size = 26)+
scale_fill_manual(values =c("#FFD04D","#1DA362","#4587F4"))+#注意颜色顺序
theme(legend.position = "none",
axis.text.x=element_blank(),
axis.line.x=element_blank(),
axis.ticks.x=element_blank())+
theme(axis.text.x = element_text(size = 26, color = "black"))+
theme(axis.text.y = element_text(size = 26, color = "black"))+
theme(title=element_text(size=26))+ theme(axis.line=element_line(size=1))
print(p2)
####作堆积条形图
p2<-ggplot(dat, aes(x=factor(1),y=perc,fill=var, group = var))+
geom_bar(stat="identity")+ #堆积条形图
geom_text(aes(label = label), position = position_stack(vjust = 0.45)) + # Add labels A, B, C +
theme(axis.text.x = element_blank())+labs(x = "",y = "Relative effect (%)")+
theme_classic(base_size = 26)+
scale_fill_manual(values =c("#FFD04D","#1DA362","#4587F4"))+#注意颜色顺序
theme(legend.position = "none",
axis.text.x=element_blank(),
axis.line.x=element_blank(),
axis.ticks.x=element_blank())+
theme(axis.text.x = element_text(size = 26, color = "black"))+
theme(axis.text.y = element_text(size = 26, color = "black"))+
theme(title=element_text(size=26))+ theme(axis.line=element_line(size=1))
print(p2)
####作堆积条形图
p2<-ggplot(dat, aes(x=factor(1),y=perc,fill=var, group = var))+
geom_bar(stat="identity")+ #堆积条形图
geom_text(aes(label = label), position = position_stack(vjust = 0.45)) + # Add labels A, B, C +
theme(axis.text.x = element_blank())+labs(x = "",y = "Relative effect (%)")+
theme_classic(base_size = 26)+
scale_fill_manual(values =c("#FFD04D","#1DA362","#4587F4"))+#注意颜色顺序
theme(legend.position = "none",
axis.text.x=element_blank(),
axis.line.x=element_blank(),
axis.ticks.x=element_blank())+
theme(axis.text.x = element_text(size = 26, color = "black"))+
theme(axis.text.y = element_text(size = 26, color = "black"))+
theme(title=element_text(size=26))+ theme(axis.line=element_line(size=1))
print(p2)
p2<-ggplot(dat, aes(x=factor(1),y=perc,fill=var, group = var))+
geom_bar(stat="identity")+ #堆积条形图
geom_text(aes(label = label), position = position_stack(vjust = 0.45), size = 20) + # Add labels A, B, C +
theme(axis.text.x = element_blank())+labs(x = "",y = "Relative effect (%)")+
theme_classic(base_size = 26)+
scale_fill_manual(values =c("#FFD04D","#1DA362","#4587F4"))+#注意颜色顺序
theme(legend.position = "none",
axis.text.x=element_blank(),
axis.line.x=element_blank(),
axis.ticks.x=element_blank())+
theme(axis.text.x = element_text(size = 26, color = "black"))+
theme(axis.text.y = element_text(size = 26, color = "black"))+
theme(title=element_text(size=26))+ theme(axis.line=element_line(size=1))
print(p2)
####作堆积条形图
p2<-ggplot(dat, aes(x=factor(1),y=perc,fill=var, group = var))+
geom_bar(stat="identity")+ #堆积条形图
geom_text(aes(label = label), position = position_stack(vjust = 0.45), size = 16) + # Add labels A, B, C +
theme(axis.text.x = element_blank())+labs(x = "",y = "Relative effect (%)")+
theme_classic(base_size = 26)+
scale_fill_manual(values =c("#FFD04D","#1DA362","#4587F4"))+#注意颜色顺序
theme(legend.position = "none",
axis.text.x=element_blank(),
axis.line.x=element_blank(),
axis.ticks.x=element_blank())+
theme(axis.text.x = element_text(size = 26, color = "black"))+
theme(axis.text.y = element_text(size = 26, color = "black"))+
theme(title=element_text(size=26))+ theme(axis.line=element_line(size=1))
print(p2)
####作堆积条形图
p2<-ggplot(dat, aes(x=factor(1),y=perc,fill=var, group = var))+
geom_bar(stat="identity")+ #堆积条形图
geom_text(aes(label = label), position = position_stack(vjust = 0.45), size = 14) + # Add labels A, B, C +
theme(axis.text.x = element_blank())+labs(x = "",y = "Relative effect (%)")+
theme_classic(base_size = 26)+
scale_fill_manual(values =c("#FFD04D","#1DA362","#4587F4"))+#注意颜色顺序
theme(legend.position = "none",
axis.text.x=element_blank(),
axis.line.x=element_blank(),
axis.ticks.x=element_blank())+
theme(axis.text.x = element_text(size = 26, color = "black"))+
theme(axis.text.y = element_text(size = 26, color = "black"))+
theme(title=element_text(size=26))+ theme(axis.line=element_line(size=1))
print(p2)
####拼图
p2<-ggplot(dat, aes(x=factor(1),y=perc,fill=var, group = var))+
geom_bar(stat="identity")+ #堆积条形图
geom_text(aes(label = label), position = position_stack(vjust = 0.45), size = 12) + # Add labels A, B, C +
theme(axis.text.x = element_blank())+labs(x = "",y = "Relative effect (%)")+
theme_classic(base_size = 26)+
scale_fill_manual(values =c("#FFD04D","#1DA362","#4587F4"))+#注意颜色顺序
theme(legend.position = "none",
axis.text.x=element_blank(),
axis.line.x=element_blank(),
axis.ticks.x=element_blank())+
theme(axis.text.x = element_text(size = 26, color = "black"))+
theme(axis.text.y = element_text(size = 26, color = "black"))+
theme(title=element_text(size=26))+ theme(axis.line=element_line(size=1))
print(p2)
p2<-ggplot(dat, aes(x=factor(1),y=perc,fill=var, group = var))+
geom_bar(stat="identity")+ #堆积条形图
geom_text(aes(label = label), position = position_stack(vjust = 0.45), size = 12) + # Add labels A, B, C +
theme(axis.text.x = element_blank())+labs(x = "",y = "Relative effect (%)")+
theme_classic(base_size = 26)+
scale_fill_manual(values =c("#FFD04D","#1DA362","#4587F4"))+#注意颜色顺序
theme(legend.position = "none",
axis.text.x=element_blank(),
axis.line.x=element_blank(),
axis.ticks.x=element_blank())+
theme(axis.text.x = element_text(size = 26, color = "black"))+
theme(axis.text.y = element_text(size = 26, color = "black"))+
theme(title=element_text(size=26))+ theme(axis.line=element_line(size=1))
print(p2)
####作堆积条形图
p2<-ggplot(dat, aes(x=factor(1),y=perc,fill=var, group = var))+
geom_bar(stat="identity")+ #堆积条形图
geom_text(aes(label = label), position = position_stack(vjust = 0.5), size = 10) + # Add labels A, B, C +
theme(axis.text.x = element_blank())+labs(x = "",y = "Relative effect (%)")+
theme_classic(base_size = 26)+
scale_fill_manual(values =c("#FFD04D","#1DA362","#4587F4"))+#注意颜色顺序
theme(legend.position = "none",
axis.text.x=element_blank(),
axis.line.x=element_blank(),
axis.ticks.x=element_blank())+
theme(axis.text.x = element_text(size = 26, color = "black"))+
theme(axis.text.y = element_text(size = 26, color = "black"))+
theme(title=element_text(size=26))+ theme(axis.line=element_line(size=1))
print(p2)
####作堆积条形图
p2<-ggplot(dat, aes(x=factor(1),y=perc,fill=var, group = var))+
geom_bar(stat="identity")+ #堆积条形图
geom_text(aes(label = label), position = position_stack(vjust = 0.5), size = 10) + # Add labels A, B, C +
theme(axis.text.x = element_blank())+labs(x = "",y = "Relative effect (%)")+
theme_classic(base_size = 26)+
scale_fill_manual(values =c("#FFD04D","#1DA362","#4587F4"))+#注意颜色顺序
theme(legend.position = "none",
axis.text.x=element_blank(),
axis.line.x=element_blank(),
axis.ticks.x=element_blank())+
theme(axis.text.x = element_text(size = 26, color = "black"))+
theme(axis.text.y = element_text(size = 26, color = "black"))+
theme(title=element_text(size=26))+ theme(axis.line=element_line(size=1))
print(p2)
####作堆积条形图
p2<-ggplot(dat, aes(x=factor(1),y=perc,fill=var, group = var))+
geom_bar(stat="identity")+ #堆积条形图
geom_text(aes(label = label), position = position_stack(vjust = 0.5), size = 8) + # Add labels A, B, C +
theme(axis.text.x = element_blank())+labs(x = "",y = "Relative effect (%)")+
theme_classic(base_size = 26)+
scale_fill_manual(values =c("#FFD04D","#1DA362","#4587F4"))+#注意颜色顺序
theme(legend.position = "none",
axis.text.x=element_blank(),
axis.line.x=element_blank(),
axis.ticks.x=element_blank())+
theme(axis.text.x = element_text(size = 26, color = "black"))+
theme(axis.text.y = element_text(size = 26, color = "black"))+
theme(title=element_text(size=26))+ theme(axis.line=element_line(size=1))
print(p2)
####作堆积条形图
p2<-ggplot(dat, aes(x=factor(1),y=perc,fill=var, group = var))+
geom_bar(stat="identity")+ #堆积条形图
geom_text(aes(label = label), position = position_stack(vjust = 0.5), size = 8) + # Add labels A, B, C +
theme(axis.text.x = element_blank())+labs(x = "",y = "Relative effect (%)")+
theme_classic(base_size = 26)+
scale_fill_manual(values =c("#FFD04D","#1DA362","#4587F4"))+#注意颜色顺序
theme(legend.position = "none",
axis.text.x=element_blank(),
axis.line.x=element_blank(),
axis.ticks.x=element_blank())+
theme(axis.text.x = element_text(size = 26, color = "black"))+
theme(axis.text.y = element_text(size = 26, color = "black"))+
theme(title=element_text(size=26))+ theme(axis.line=element_line(size=1))
print(p2)
